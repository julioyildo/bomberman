"use strict";var bomb=function(e,a,b){this.bomb_power=a,this.bomb_number=e,this.bomb_timer=b,this.bomb_pusher=!1,this.bombs=[],this.putBomb=function(){var e=this;window.addEventListener("keydown",function(a){a.preventDefault,32==a.keyCode&&e.bomb_number>0&&(this.bomb_PosX=set_player.playerPosX,this.bomb_PosY=set_player.playerPosY,this.bomb=document.createElement("div"),this.bomb.style.top=create_map.general_table_game[this.bomb_PosX][this.bomb_PosY].element.offsetTop+"px",this.bomb.style.left=create_map.general_table_game[this.bomb_PosX][this.bomb_PosY].element.offsetLeft+"px",this.bomb.classList.add("bomb"),this.bomb.classList.add("bomb3"),document.querySelector(".table").appendChild(this.bomb),e.bombs.push([this.bomb,this.bomb_PosX,this.bomb_PosY,e.bomb_timer,!1,!1,!1,!1,!1,!1,!1,!1]),e.bomb_number--,e.explodeBomb(e.bombs.length-1))})},this.explodeBomb=function(e){var a=this;this.unbreakableBlockUp=!1,this.unbreakableBlockDown=!1,this.unbreakableBlockLeft=!1,this.unbreakableBlockRight=!1,this.breakableBlockUp=!1,this.breakableBlockDown=!1,this.breakableBlockLeft=!1,this.breakableBlockRight=!1;var s=setInterval(function(){a.bombs[e][3]--,2==a.bombs[e][3]?(a.bombs[e][0].classList.remove("bomb3"),a.bombs[e][0].classList.add("bomb2")):1==a.bombs[e][3]?(a.bombs[e][0].classList.remove("bomb2"),a.bombs[e][0].classList.add("bomb1")):0==a.bombs[e][3]&&(a.bombs[e][0].classList.remove("bomb1"),a.bombs[e][0].classList.add("bomb0"),setTimeout(function(){for(var b=1;b<a.bomb_power;b++)a.bombs[e][1]+b<create_map.general_table_game.length&&create_map.general_table_game[a.bombs[e][1]+b][a.bombs[e][2]].breakable&&!a.bombs[e][5]&&!a.bombs[e][9]?(create_map.general_table_game[a.bombs[e][1]+b][a.bombs[e][2]].breakable=null,create_map.general_table_game[a.bombs[e][1]+b][a.bombs[e][2]].element.classList.remove("breakable"),create_map.general_table_game[a.bombs[e][1]+b][a.bombs[e][2]].item&&create_map.general_table_game[a.bombs[e][1]+b][a.bombs[e][2]].element.classList.add(create_map.general_table_game[a.bombs[e][1]+b][a.bombs[e][2]].value_item),a.bombs[e][5]=!0):a.bombs[e][1]+b<create_map.general_table_game.length&&0==create_map.general_table_game[a.bombs[e][1]+b][a.bombs[e][2]].breakable&&(a.bombs[e][9]=!0),a.bombs[e][1]-b>=0&&create_map.general_table_game[a.bombs[e][1]-b][a.bombs[e][2]].breakable&&!a.bombs[e][6]&&!a.bombs[e][10]?(create_map.general_table_game[a.bombs[e][1]-b][a.bombs[e][2]].breakable=null,create_map.general_table_game[a.bombs[e][1]-b][a.bombs[e][2]].element.classList.remove("breakable"),create_map.general_table_game[a.bombs[e][1]-b][a.bombs[e][2]].item&&create_map.general_table_game[a.bombs[e][1]-b][a.bombs[e][2]].element.classList.add(create_map.general_table_game[a.bombs[e][1]-b][a.bombs[e][2]].value_item),a.bombs[e][6]=!0):a.bombs[e][1]-b>=0&&0==create_map.general_table_game[a.bombs[e][1]-b][a.bombs[e][2]].breakable&&(a.bombs[e][10]=!0),a.bombs[e][2]+b<create_map.general_table_game.length&&create_map.general_table_game[this.bomb_PosX][a.bombs[e][2]+b].breakable&&!a.bombs[e][7]&&!a.bombs[e][11]?(create_map.general_table_game[a.bombs[e][1]][a.bombs[e][2]+b].breakable=null,create_map.general_table_game[a.bombs[e][1]][a.bombs[e][2]+b].element.classList.remove("breakable"),create_map.general_table_game[a.bombs[e][1]][a.bombs[e][2]+b].item&&create_map.general_table_game[a.bombs[e][1]][a.bombs[e][2]+b].element.classList.add(create_map.general_table_game[a.bombs[e][1]][a.bombs[e][2]+b].value_item),a.bombs[e][7]=!0):a.bombs[e][2]+b<create_map.general_table_game.length&&0==create_map.general_table_game[this.bomb_PosX][a.bombs[e][2]+b].breakable&&(a.bombs[e][11]=!0),a.bombs[e][2]-b>=0&&create_map.general_table_game[a.bombs[e][1]][a.bombs[e][2]-b].breakable&&!a.bombs[e][8]&&!a.bombs[e][12]?(create_map.general_table_game[a.bombs[e][1]][a.bombs[e][2]-b].breakable=null,create_map.general_table_game[a.bombs[e][1]][a.bombs[e][2]-b].element.classList.remove("breakable"),create_map.general_table_game[a.bombs[e][1]][a.bombs[e][2]-b].item&&create_map.general_table_game[a.bombs[e][1]][a.bombs[e][2]-b].element.classList.add(create_map.general_table_game[a.bombs[e][1]][a.bombs[e][2]-b].value_item),a.bombs[e][8]=!0):a.bombs[e][2]-b>=0&&0==create_map.general_table_game[a.bombs[e][1]][a.bombs[e][2]-b].breakable&&(a.bombs[e][12]=!0),a.bombs[e][1]+b!=set_player.playerPosX||a.bombs[e][2]!=set_player.playerPosY||a.bombs[e][5]||a.bombs[e][9]||(window.alert("You lost !"),location.reload()),a.bombs[e][1]-b!=set_player.playerPosX||a.bombs[e][2]!=set_player.playerPosY||a.bombs[e][6]||a.bombs[e][10]||(window.alert("You lost !"),location.reload()),a.bombs[e][1]!=set_player.playerPosX||a.bombs[e][2]+b!=set_player.playerPosY||a.bombs[e][7]||a.bombs[e][11]||(window.alert("You lost !"),location.reload()),a.bombs[e][1]!=set_player.playerPosX||a.bombs[e][2]-b!=set_player.playerPosY||a.bombs[e][8]||a.bombs[e][12]||(window.alert("You lost !"),location.reload()),a.bombs[e][1]+b!=set_player.botPosX||a.bombs[e][2]!=set_player.botPosY||a.bombs[e][5]||a.bombs[e][9]||(window.alert("You win !"),location.reload()),a.bombs[e][1]-b!=set_player.botPosX||a.bombs[e][2]!=set_player.botPosY||a.bombs[e][6]||a.bombs[e][10]||(window.alert("You win !"),location.reload()),a.bombs[e][1]!=set_player.botPosX||a.bombs[e][2]+b!=set_player.botPosY||a.bombs[e][7]||a.bombs[e][11]||(window.alert("You win !"),location.reload()),a.bombs[e][1]!=set_player.botPosX||a.bombs[e][2]-b!=set_player.botPosY||a.bombs[e][8]||a.bombs[e][12]||(window.alert("You win !"),location.reload());a.bomb_number++,a.bombs[e][0].remove(),a.bombs[e]=[]},300),clearInterval(s))},b/3*1e3)}},set_bomb=new bomb(1,2,3);set_bomb.putBomb();var bot=function(){this.botAction=function(){setInterval(function(){if(set_bomb.bombs.length>0){for(var e=0;e<set_bomb.bombs.length;e++)for(var a=0;a<set_bomb.bomb_power;a++)(set_bomb.bombs[e][1]+a==set_player.botPosX&&set_bomb.bombs[e][2]==set_player.botPosY||set_bomb.bombs[e][1]-a==set_player.botPosX&&set_bomb.bombs[e][2]==set_player.botPosY||set_bomb.bombs[e][1]==set_player.botPosX&&set_bomb.bombs[e][2]+a==set_player.botPosY||set_bomb.bombs[e][1]==set_player.botPosX&&set_bomb.bombs[e][2]-a==set_player.botPosY)&&(set_player.botPosY-1>=0&&null==create_map.general_table_game[set_player.botPosX][set_player.botPosY-1].breakable?(set_player.botPosY-1==set_bomb.bombs[e][1]&&set_player.botPosX==set_bomb.bombs[e][0]&&(set_bomb.botPosY+=1),set_player.botPosY-=1):set_player.botPosX-1>=0&&null==create_map.general_table_game[set_player.botPosX-1][set_player.botPosY].breakable?(set_player.botPosY==set_bomb.bombs[e][1]&&set_player.botPosX-1==set_bomb.bombs[e][0]&&(set_player.botPosX+=1),set_player.botPosX-=1):set_player.botPosY+1<create_map.general_table_game.length&&null==create_map.general_table_game[set_player.botPosX][set_player.botPosY+1].breakable?(set_player.botPosY+1==set_bomb.bombs[e][1]&&set_player.botPosX==set_bomb.bombs[e][0]&&(set_player.botPosY-=1),set_player.botPosY+=1):set_player.botPosX+1<create_map.general_table_game.length&&null==create_map.general_table_game[set_player.botPosX+1][set_player.botPosY].breakable&&(set_player.botPosY==set_bomb.bombs[e][1]&&set_player.botPosX+1==set_bomb.bombs[e][0]&&(set_player.botPosX-=1),set_player.botPosX+=1));set_player.bot_player.style.top=create_map.general_table_game[set_player.botPosX][set_player.botPosY].element.offsetTop+"px",set_player.bot_player.style.left=create_map.general_table_game[set_player.botPosX][set_player.botPosY].element.offsetLeft+"px"}},50)}},set_bot=new bot;set_bot.botAction();var items=function(){this.playerItems=function(){window.addEventListener("keydown",function(e){create_map.general_table_game[set_player.playerPosX][set_player.playerPosY].item&&("bomb_area_bonus"==create_map.general_table_game[set_player.playerPosX][set_player.playerPosY].value_item?set_bomb.bomb_power++:"push_bombs"==create_map.general_table_game[set_player.playerPosX][set_player.playerPosY].value_item?set_bomb.bomb_pusher=!0:"more_bombs"==create_map.general_table_game[set_player.playerPosX][set_player.playerPosY].value_item&&set_bomb.bomb_number++,create_map.general_table_game[set_player.playerPosX][set_player.playerPosY].item=!1,create_map.general_table_game[set_player.playerPosX][set_player.playerPosY].element.className="cell")})}},set_items=new items;set_items.playerItems();var map=function(e,a,b,s,t,o){this.container=document.querySelector(".bomberman-map"),this.table_size=e,this.breakable_bumber=a,this.items=b,this.bombe_plus_one=s,this.bombe_area_bonus=t,this.push_bombs=o,this.general_table_game=[],this.is_empty=[],this.is_breakable=[],this.is_item=[],this.create_map=function(){var e=document.createElement("div");e.className="table";for(var a=0;a<this.table_size;a++){this.general_table_game.push([]);var b=document.createElement("div");b.className="row";for(var s=0;s<this.table_size;s++){var t=document.createElement("div");t.className="cell",b.appendChild(t),this.general_table_game[a].push({x:a,y:s,element:t,breakable:null,item:null,value_item:null})}e.appendChild(b)}this.container.appendChild(e)},console.log(this.general_table_game),this.unbreakable=function(){for(var e=1;e<this.general_table_game.length-1;e+=2)for(var a=1;a<this.general_table_game[e].length-1;a+=2)this.general_table_game[e][a].breakable=!1,this.general_table_game[e][a].element.classList.add("unbreakable")},this.isEmpty=function(){for(var e=0;e<this.general_table_game.length;e++)for(var a=0;a<this.general_table_game[e].length;a++)null==this.general_table_game[e][a].breakable&&this.is_empty.push(this.general_table_game[e][a])},this.breakable=function(){for(var e=0;e<this.breakable_bumber;e++){var a=this.is_empty.slice(3,this.is_empty.length-3),b=Math.floor(Math.random()*a.length);a[b].breakable=!0,a[b].element.classList.add("breakable"),this.is_breakable.push(a[b])}},this.element=function(){for(var e=0;e<this.items;e++){var a=Math.floor(Math.random()*this.is_breakable.length);this.is_breakable[a].item?e--:(this.is_breakable[a].item=!0,this.is_breakable[a].element.classList.add("item"),this.is_item.push(this.is_breakable[a]))}},console.log(this.is_item),this.element_value=function(){this.value_items=["more_bombs","bomb_area_bonus","push_bombs"];for(var e=0;e<this.is_item.length;e++){var a=Math.floor(Math.random()*this.value_items.length);"more_bombs"===this.value_items[a]&&this.bombe_plus_one>0?(this.is_item[e].value_item=this.value_items[a],this.bombe_plus_one--):"bomb_area_bonus"===this.value_items[a]&&this.bombe_area_bonus>0?(this.is_item[e].value_item=this.value_items[a],this.bombe_area_bonus--):"push_bombs"===this.value_items[a]&&this.push_bombs>0?(this.is_item[e].value_item=this.value_items[a],this.push_bombs--):e--}}},create_map=new map(11,200,18,6,10,2);create_map.create_map(),create_map.unbreakable(),create_map.isEmpty(),create_map.breakable(),create_map.element(),create_map.element_value();var player=function(e){this.player_number=e,this.players_positions=[{x:0,y:0},{x:create_map.general_table_game.length-1,y:create_map.general_table_game.length-1}],this.createPlayer=function(){for(var e=0;e<this.player_number;e++)this.player_element=document.createElement("div"),document.querySelector(".table").appendChild(this.player_element),this.player_element.style.top=create_map.general_table_game[this.players_positions[e].x][this.players_positions[e].y].element.offsetTop+"px",this.player_element.style.left=create_map.general_table_game[this.players_positions[e].x][this.players_positions[e].y].element.offsetLeft+"px",0==e?(this.player_element.classList.add("player"),this.player_element.classList.add("down"),this.real_player=this.player_element,this.playerPosX=this.players_positions[0].x,this.playerPosY=this.players_positions[0].y):(this.player_element.classList.add("bot"),this.bot_player=this.player_element,this.botPosX=this.players_positions[e].x,this.botPosY=this.players_positions[e].y)},this.movePlayer=function(){var e=this;window.addEventListener("keydown",function(a){if(a.preventDefault(),37==a.keyCode){if(e.playerPosY-1>=0&&null==create_map.general_table_game[e.playerPosX][e.playerPosY-1].breakable){if(set_bomb.bombs.length>0)for(var b=0;b<set_bomb.bombs.length;b++)if(e.playerPosY-1==set_bomb.bombs[b][2]&&e.playerPosX==set_bomb.bombs[b][1]){if(set_bomb.bomb_pusher){for(var s=0;s<create_map.general_table_game.length-(create_map.general_table_game.length-set_bomb.bombs[b][2]+1)&&null==create_map.general_table_game[set_bomb.bombs[b][1]][set_bomb.bombs[b][2]-s].breakable;)s++;set_bomb.bombs[b][2]=set_bomb.bombs[b][2]-s-1,set_bomb.bombs[b][0].style.left=create_map.general_table_game[set_bomb.bombs[b][1]][set_bomb.bombs[b][2]].element.offsetLeft+"px"}e.playerPosY+=1}e.real_player.className="player",e.real_player.classList.add("left"),setTimeout(function(){e.real_player.classList.add("left1")},25),setTimeout(function(){e.real_player.classList.remove("left1"),e.real_player.classList.add("left2")},50),setTimeout(function(){e.real_player.classList.remove("left2"),e.real_player.classList.add("left3")},75),setTimeout(function(){e.real_player.classList.remove("left3")},100),e.playerPosY-=1}}else if(38==a.keyCode){if(e.playerPosX-1>=0&&null==create_map.general_table_game[e.playerPosX-1][e.playerPosY].breakable){if(set_bomb.bombs.length>0)for(var t=0;t<set_bomb.bombs.length;t++)if(e.playerPosY==set_bomb.bombs[t][2]&&e.playerPosX-1==set_bomb.bombs[t][1]){if(set_bomb.bomb_pusher){for(var o=0;o<create_map.general_table_game.length-(create_map.general_table_game.length-set_bomb.bombs[t][1]+1)&&null==create_map.general_table_game[set_bomb.bombs[t][1]-o][set_bomb.bombs[t][2]].breakable;)o++;set_bomb.bombs[t][1]=set_bomb.bombs[t][1]-o-1,set_bomb.bombs[t][0].style.top=create_map.general_table_game[set_bomb.bombs[t][1]][set_bomb.bombs[t][2]].element.offsetTop+"px"}e.playerPosX+=1}e.real_player.className="player",e.real_player.classList.add("up"),setTimeout(function(){e.real_player.classList.add("up1")},25),setTimeout(function(){e.real_player.classList.remove("up1"),e.real_player.classList.add("up2")},50),setTimeout(function(){e.real_player.classList.remove("up2"),e.real_player.classList.add("up3")},75),setTimeout(function(){e.real_player.classList.remove("up3")},100),e.playerPosX-=1}}else if(39==a.keyCode){if(e.playerPosY+1<create_map.general_table_game.length&&null==create_map.general_table_game[e.playerPosX][e.playerPosY+1].breakable){if(set_bomb.bombs.length>0)for(var l=0;l<set_bomb.bombs.length;l++)if(e.playerPosY+1==set_bomb.bombs[l][2]&&e.playerPosX==set_bomb.bombs[l][1]){if(set_bomb.bomb_pusher){for(var m=0;null==create_map.general_table_game[set_bomb.bombs[l][1]][set_bomb.bombs[l][2]+m].breakable&&m<create_map.general_table_game.length-set_bomb.bombs[l][2]-1;)m++;set_bomb.bombs[l][2]=set_bomb.bombs[l][2]+m-1,set_bomb.bombs[l][0].style.left=create_map.general_table_game[set_bomb.bombs[l][1]][set_bomb.bombs[l][2]].element.offsetLeft+"px"}e.playerPosY-=1}e.real_player.className="player",e.real_player.classList.add("right"),setTimeout(function(){e.real_player.classList.add("right1")},25),setTimeout(function(){e.real_player.classList.remove("right1"),e.real_player.classList.add("right2")},50),setTimeout(function(){e.real_player.classList.remove("right2"),e.real_player.classList.add("right3")},75),setTimeout(function(){e.real_player.classList.remove("right3")},100),e.playerPosY+=1}}else if(40==a.keyCode&&e.playerPosX+1<create_map.general_table_game.length&&null==create_map.general_table_game[e.playerPosX+1][e.playerPosY].breakable){if(set_bomb.bombs.length>0)for(var r=0;r<set_bomb.bombs.length;r++)if(e.playerPosY==set_bomb.bombs[r][2]&&e.playerPosX+1==set_bomb.bombs[r][1]){if(set_bomb.bomb_pusher){for(var _=0;null==create_map.general_table_game[set_bomb.bombs[r][1]+_][set_bomb.bombs[r][2]].breakable&&_<create_map.general_table_game.length-set_bomb.bombs[r][1]-1;)_++;set_bomb.bombs[r][1]=set_bomb.bombs[r][1]+_-1,set_bomb.bombs[r][0].style.top=create_map.general_table_game[set_bomb.bombs[r][1]][set_bomb.bombs[r][2]].element.offsetTop+"px"}e.playerPosX-=1}e.real_player.className="player",e.real_player.classList.add("down"),setTimeout(function(){e.real_player.classList.add("down1")},25),setTimeout(function(){e.real_player.classList.remove("down1"),e.real_player.classList.add("down2")},50),setTimeout(function(){e.real_player.classList.remove("down2"),e.real_player.classList.add("down3")},75),setTimeout(function(){e.real_player.classList.remove("down3")},100),e.playerPosX+=1}e.real_player.style.top=create_map.general_table_game[e.playerPosX][e.playerPosY].element.offsetTop+"px",e.real_player.style.left=create_map.general_table_game[e.playerPosX][e.playerPosY].element.offsetLeft+"px"})}},set_player=new player(2);set_player.createPlayer(),set_player.movePlayer();